\section{Optimality Systems and \textit{a posteriori} Error Estimates}

\begin{frame}{Primal and Dual Equations}
    \begin{block}{Primal Residual}
        For $u, v \in V, \mu \in \mathcal{P}$ we define
        \begin{equation*}
            Res_\mu^{pr}(u)[v] := l_\mu(v) - a_\mu(u, v).
        \end{equation*}
    \end{block}
    \begin{block}{Dual Residual}
        For $u, v, p \in V, \mu \in \mathcal{P}$ we define
        \begin{equation*}
            Res_\mu^{du}(u, p)[v] := j_\mu(v) + 2 k_\mu(v, u) - a_\mu(v, p).
        \end{equation*}
    \end{block}
\end{frame}

\begin{frame}{Optimality Conditions}
    \textbf{Lagrangian:} $\mathcal{L}(u, \mu, p) := \mathcal{J}(u, \mu) - Res_\mu^{pr}(u)[p]$

    \begin{block}{First Order Necessary Conditions, c.f.~\cite{Keil2021}}
        For any locally optimal pair $(u, \mu)$ there exists an optimal dual variable $p \in V$ such that the following conditions are satisfied
        \begin{align*}
            a_\mu(u, v) &= l_\mu(v) &&\forall v \in V \\
            a_\mu(u, p) &= \partial_u \mathcal{J}(u, \mu)[v] &&\forall v \in V \\
            0 &\leq \nabla_\mu \mathcal{L}(u, \mu, p) \cdot (\nu - \mu) &&\forall \nu \in \mathcal{P}.
        \end{align*}
    \end{block}
\end{frame}

\begin{frame}{Optimality Conditions --- Standard Approach}
    \begin{block}{Reduced Functional}
        For $\mu \in \mathcal{P}$ we define
        \begin{equation*}
            J_N(\mu) := \mathcal{J}(u_{N, \mu}, \mu),
        \end{equation*}
        where $u_{N, \mu}$ defines the reduced solution for $\mu$.
    \end{block}
    Then the gradient for all $p \in V_N^{du}$ is
    \begin{equation*}
        {\left( \nabla_\mu J_N(\mu) \right)}_i = \partial_u \mathcal{L}(u_{N, \mu}, \mu, p)[d_{\mu_i} u_{N, \mu}] + \partial_{\mu_i} \mathcal{L}(u_{N, \mu}, \mu, p) \quad \forall p \in V_N^{du}.
    \end{equation*}
\end{frame}

\begin{frame}{Optimality Conditions --- NCD-Corrected Approach}
    \only<1>{
        \begin{block}{NCD-Corrected Functional, c.f.~\cite{Keil2021}}
            For $u_{N, \mu} \in V_N^{pr}, p_{N, \mu} \in V_N^{du}$ we define
            \begin{equation*}
                \mathcal{J}_N(\mu) := \mathcal{L}(u_{N, \mu}, \mu, p_{N, \mu}) = J_N(\mu) + Res_\mu^{pr}(u_{N, \mu})[p_{N, \mu}]
            \end{equation*}
        \end{block}
    }
    \only<2>{
        \begin{block}{NCD-Corrected Gradient, Standard Approach, c.f.~\cite{Keil2021}}
            For $v_{N, \mu} \in V_N^{pr}, p_{N, \mu} \in V_N^{du}$ we get
            \begin{align*}
                {\left( \nabla_\mu \mathcal{J}_N (\mu) \right)}_i &= \partial_{\mu_i} \mathcal{J}(u_{N, \mu}, \mu) \\
                &+ \partial_{\mu_i} Res_\mu^{pr}(u_{N, \mu})[p_{N, \mu} + w_{N, \mu}] - \partial_{\mu_i} Res_\mu^{du}(u_{N, \mu}, p_{N, \mu})[z_{N, \mu}],
            \end{align*}
            where $z_{N, \mu} \in V_N^{du}, w_{N, \mu} \in V_N^{pr}$ satisfy
            \begin{align*}
                a_\mu(z_{N, \mu}, q) &= - Res_\mu^{pr}(u_{N, \mu})[q] &&\forall q \in V_N^{du}, \text{ and} \\
                a_\mu(v, w_{N, \mu}) &= Res_\mu^{du}(u_{N, \mu}, p_{N, \mu})[v] - 2 k_\mu(z_{N, \mu}, v) &&\forall v \in V_N^{pr}.
            \end{align*}
        \end{block}
    }
\end{frame}

\begin{frame}{\textit{a posteriori} Error Estimates}
    \only<1>{
        \begin{block}{Model Reduction Error, c.f.~\cite{Qian2017, Keil2021}}
            For some $\mu \in \mathcal{P}$ we consider the solutions $u_\mu \in V, u_{N, \mu} \in V_N^{pr}, p_\mu \in V, p_{N, \mu} \in V_N^{du}$.
            Then it holds that
            \begin{align*}
                \norm{u_\mu - u_{N, \mu}} &\leq \Delta_{pr}(\mu) := {\alpha_\mu}^{-1} \norm{Res_\mu^{pr}(u_{N, \mu})}, \text{ and} \\
                \norm{p_\mu - p_{N, \mu}} &\leq \Delta_{du}(\mu) := {\alpha_\mu}^{-1} \left(2 \gamma_{k_\mu} \Delta_{pr}(\mu) + \norm{Res_\mu^{du}(u_{N, \mu}, p_{N, \mu})} \right).
            \end{align*}
        \end{block}
    }
    \only<2>{
        \begin{equation*}
            \norm{u_\mu - u_{N, \mu}} \leq \Delta_{pr}(\mu), \qquad \norm{p_\mu - p_{N, \mu}} \leq \Delta_{du}(\mu)
        \end{equation*}
        \begin{block}{Output Model Reduction Error, c.f.~\cite{Qian2017, Keil2021}}
            For $\mu \in \mathcal{P}, u_\mu \in V, u_{N, \mu} \in V_N^{pr}, p_\mu \in V, p_{N, \mu} \in V_N^{du}$ we have
            \begin{align*}
                \abs{\mathcal{J}(u_\mu, \mu) - J_N(\mu)} &\leq \Delta_{J_N}(\mu) := \Delta_{pr}(\mu) \norm{Res_\mu^{du}(u_{N, \mu}, p_{N, \mu})} \\
                &+ {\Delta_{pr}(\mu)}^2 \gamma_{k_\mu} + \abs{Res_\mu^{pr}(u_{N, \mu})[p_{N, \mu}]}, \text{ and} \\
                \abs{\mathcal{J}(u_\mu, \mu) - \mathcal{J}_N(\mu)} &\leq \Delta_{\mathcal{J}_N}(\mu) := \Delta_{pr}(\mu) \norm{Res_\mu^{du}(u_{N, \mu}, p_{N, \mu})} + {\Delta_{pr}(\mu)}^2 \gamma_{k_\mu}.
            \end{align*}
        \end{block}
    }
    \only<3>{
        \begin{equation*}
            \abs{\mathcal{J}(u_\mu, \mu) - \mathcal{J}_N(\mu)} \leq \Delta_{\mathcal{J}_N}(\mu)
        \end{equation*}
        \begin{block}{Output Gradient Model Reduction Error, c.f.~\cite{Qian2017, Keil2021}}
            For $\mu \in \mathcal{P}, u_\mu \in V, u_{N, \mu} \in V_N^{pr}, p_\mu \in V, p_{N, \mu} \in V_N^{du}$ we have
            \begin{equation*}
                \norm[2]{\nabla_\mu \mathcal{J}(u_\mu, \mu) - \nabla_\mu \mathcal{J}_N(\mu)} \leq \Delta_{\nabla \mathcal{J}_N}(\mu) := \norm[2]{\Delta^\ast_{\nabla \mathcal{J}_N}(\mu)}.
            \end{equation*}
        \end{block}
    }
\end{frame}